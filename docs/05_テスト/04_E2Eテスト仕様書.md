# E2Eテスト仕様書

> AWS Multi-Account Sample Application

---

## 1. テスト概要

### 1.1 目的
システム全体の動作を確認する。

### 1.2 対象シナリオ
1. ユーザー登録〜注文完了
2. 管理者ダッシュボード確認
3. バッチ処理実行
4. Transit Gateway接続確認

---

## 2. テストシナリオ

### 2.1 シナリオ1: ユーザー登録〜注文完了

**前提条件**:
- Public Web Service が起動している
- RDS に商品データが存在する

**テスト手順**:

| Step | 操作 | 期待結果 |
|------|------|---------|
| 1 | ユーザー登録 POST /api/users | 201 Created |
| 2 | 商品一覧取得 GET /api/products | 200 OK、商品リスト返却 |
| 3 | 注文作成 POST /api/orders | 201 Created |
| 4 | 注文確認 GET /api/orders/:id | 200 OK、注文詳細返却 |

### 2.2 シナリオ2: 管理者ダッシュボード

**前提条件**:
- Client VPN 接続済み
- Admin Dashboard が起動している

**テスト手順**:

| Step | 操作 | 期待結果 |
|------|------|---------|
| 1 | VPN接続確認 | 接続成功 |
| 2 | Admin Dashboard アクセス | 200 OK |
| 3 | 統計情報取得 GET /api/admin/stats | 200 OK、統計データ返却 |

### 2.3 シナリオ3: バッチ処理

**前提条件**:
- Batch Service が起動している
- テストデータが存在する

**テスト手順**:

| Step | 操作 | 期待結果 |
|------|------|---------|
| 1 | バッチ実行トリガー | バッチ開始 |
| 2 | CloudWatch Logs 確認 | ログ出力確認 |
| 3 | 統計テーブル確認 | データ更新確認 |

### 2.4 シナリオ4: Transit Gateway接続

**前提条件**:
- Platform Account デプロイ完了
- Service Account デプロイ完了

**テスト手順**:

| Step | 操作 | 期待結果 |
|------|------|---------|
| 1 | TGW ステータス確認 | available |
| 2 | TGW Attachment 確認 | available |
| 3 | ルートテーブル確認 | 正しいルートが設定されている |
| 4 | Ping 疎通確認 | 疎通成功 |

---

## 3. 実行方法

```bash
# E2Eテスト実行
npm run test:e2e

# 特定シナリオのみ
npm test e2e/user-registration-to-order.test.ts
```

---

## 変更履歴

| 日付 | 版数 | 変更内容 |
|------|------|----------|
| 2025-10-22 | 1.0 | 初版作成 |
